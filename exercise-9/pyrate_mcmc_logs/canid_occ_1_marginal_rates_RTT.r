# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.12858840504, 0.12858840504,0.12858840504,0.12858840504,0.120847098162,0.040480717641,0.040480717641,0.041815843813,0.040480717641,0.040480717641,0.040480717641,0.040480717641,0.040480717641,0.040480717641,0.040480717641,0.040480717641,0.041815843813,0.0610257022927,0.0681738254691,0.0681738254691,0.0891770448513,0.091696024774,0.0926465299385,0.0926465299385,0.0926465299385,0.0926465299385,0.0926465299385,0.0926465299385,0.091696024774,0.0891770448513,0.0891770448513,0.126973796231,0.123970595781,0.135027260139,0.123970595781,0.123970595781,0.123970595781,0.123970595781,0.122744865078,0.122744865078,0.101530352836,0.101530352836,0.108818014589,0.095550985127,0.095550985127,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599,0.0946843928599)
L_hpd_M95=c(0.341464521793, 0.341464521793,0.341464521793,0.341464521793,0.344684332182,0.291490258212,0.143828683555,0.143828683555,0.139439243769,0.139439243769,0.139439243769,0.139439243769,0.139439243769,0.141269370148,0.141269370148,0.143828683555,0.163156507624,0.187571939735,0.187571939735,0.187571939735,0.197110130493,0.197222199563,0.197110130493,0.197110130493,0.197110130493,0.197110130493,0.197110130493,0.197222199563,0.197222199563,0.244926237062,0.335008034129,0.409996777883,0.396019818898,0.412998344151,0.409996777883,0.409996777883,0.412998344151,0.412998344151,0.412998344151,0.421676688186,0.412998344151,0.412998344151,0.423418864799,0.409996777883,0.409996777883,0.409996777883,0.409996777883,0.409996777883,0.412998344151,0.437022966881,0.428962379084,0.428962379084,0.428962379084,0.428962379084,0.428962379084)
M_hpd_m95=c(0.767319073883, 0.767319073883,0.0886526157912,0.0886526157912,0.0874203916025,0.0864345911484,0.0864345911484,0.07593471195,0.0784304508926,0.0756254641291,0.0756254641291,0.07593471195,0.0741032502043,0.0756254641291,0.0756254641291,0.0708551074739,0.0708551074739,0.0701769378632,0.0701769378632,0.0710144371663,0.0710144371663,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0732542225324,0.0710144371663,0.0701769378632,0.0701769378632,0.0701769378632,0.0710144371663,0.0662624350021,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916,0.0217400443916)
M_hpd_M95=c(1.53948408398, 1.53948408398,0.213710904628,0.205132282361,0.203763337136,0.201365446719,0.195933921672,0.172460223184,0.165595257781,0.162742178938,0.153320178262,0.15116035339,0.147620795036,0.141936423926,0.14231108627,0.128389484212,0.125977313357,0.119133051286,0.112021645181,0.112021645181,0.114062519433,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.115126670114,0.114062519433,0.114062519433,0.120553036912,0.124289694505,0.125977313357,0.170536097742,0.163587599014,0.163587599014,0.163587599014,0.163587599014,0.163587599014,0.170536097742,0.211344420184,0.214705362929,0.214705362929,0.214705362929,0.214705362929,0.214705362929,0.214705362929,0.214705362929,0.214705362929,0.214705362929)
R_hpd_m95=c(-1.3291354947, -1.3291354947,-0.0136359323063,-0.0136359323063,-0.0136359323063,-0.13889182516,-0.13889182516,-0.13889182516,-0.111461803568,-0.111461803568,-0.102350531089,-0.0956717843666,-0.0900467610739,-0.0841500910752,-0.0812799907425,-0.0648616434704,-0.0538058077992,-0.0312119791629,-0.0191895357976,-0.0191895357976,-0.0153681687078,-0.00728346577971,-0.00157290903562,-0.00157290903562,-0.00157290903562,-0.00157290903562,-0.00157290903562,-0.00728346577971,-0.00728346577971,-0.0191895357976,-0.0212536093822,0.00594492119656,0.0341491256893,0.0527502686873,0.0501089966023,0.0401637484556,0.0362766560365,0.0362766560365,0.0112164146053,0.0112164146053,-0.0267805959424,-0.0267805959424,-0.0267805959424,-0.0222042587774,0.00578404232506,-0.0272695116167,-0.0272695116167,-0.0272695116167,-0.0272695116167,-0.0858473880581,-0.105953641538,-0.105953641538,-0.105953641538,-0.105953641538,-0.105953641538)
R_hpd_M95=c(-0.471879887473, -0.471879887473,0.240245490032,0.238912718129,0.238912718129,0.185095775376,0.0198442006776,0.0198442006776,0.0322896557639,0.0322896557639,0.0322896557639,0.0322896557639,0.0381403137795,0.0381403137795,0.0381403137795,0.0478965747545,0.0782245799901,0.094879174922,0.102585353429,0.101503481046,0.10630342198,0.11639435314,0.11639435314,0.11639435314,0.11639435314,0.11639435314,0.11639435314,0.11639435314,0.11639435314,0.160422766763,0.2423932522,0.290524985585,0.301285091588,0.334602295149,0.334602295149,0.334602295149,0.334602295149,0.334602295149,0.363821735923,0.363821735923,0.346343709284,0.346343709284,0.346343709284,0.346343709284,0.363821735923,0.363821735923,0.363821735923,0.363821735923,0.363821735923,0.358787499889,0.335763581213,0.335763581213,0.335763581213,0.335763581213,0.335763581213)
L_mean=c(0.264235084999, 0.264235084999,0.264235084999,0.264235084999,0.259242754703,0.139712526896,0.0766740474605,0.0753091409178,0.0747100880892,0.0747100880892,0.0747567529305,0.0748083155745,0.0748320137292,0.0751122970215,0.0752042171969,0.0778693641338,0.104661551559,0.132363293773,0.136791685156,0.138929365233,0.145536718636,0.147395096697,0.148428187048,0.148428187048,0.148428187048,0.148428187048,0.148428187048,0.147935419367,0.148602685105,0.157844516175,0.184002325006,0.239064336238,0.249253949757,0.258193804342,0.270272835047,0.270020783268,0.268159465939,0.266617090868,0.264493043001,0.264987951587,0.26262157011,0.261909856698,0.261749350066,0.259356022643,0.255400094621,0.257996497086,0.256158693281,0.254491384111,0.251299693755,0.255548775141,0.254150561118,0.254150561118,0.253939864129,0.253939864129,0.253939864129)
M_mean=c(1.13308393545, 1.13308393545,0.141799544299,0.140473338455,0.13914721324,0.136406349926,0.131439064087,0.125776583647,0.122747183289,0.119323283343,0.116393415514,0.112156257324,0.10733956292,0.102296940148,0.0979973618281,0.0947198660833,0.0940780939621,0.0928707785829,0.0925063607117,0.0926178311449,0.0937356813201,0.0936518005238,0.0936518005238,0.0936518005238,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0936944258188,0.0938251117551,0.0938917193818,0.0943898169228,0.0945773103695,0.0943393013288,0.0982925013049,0.0978706817935,0.0972504143474,0.0970304664657,0.0970246200791,0.0967086329133,0.0969084643277,0.101342950603,0.102014443206,0.101811978848,0.100347436536,0.10017191293,0.10017191293,0.10017191293,0.10017191293,0.10017191293,0.10017191293)
R_mean=c(-0.868848850455, -0.868848850455,0.1224355407,0.123761746544,0.120095541463,0.00330617697005,-0.0547650166269,-0.0504674427291,-0.0480370952,-0.0446131952534,-0.0416366625831,-0.0373479417495,-0.032507549191,-0.0271846431264,-0.0227931446313,-0.0168505019495,0.0105834575966,0.0394925151903,0.0442853244447,0.0463115340879,0.0518010373157,0.0537432961731,0.0547763865237,0.0547763865237,0.0547337612288,0.0547337612288,0.0547337612288,0.0542409935485,0.0549082592864,0.0641500903563,0.0903078991876,0.145369910419,0.155559523939,0.164368692587,0.176381115665,0.175630966345,0.173582155569,0.17227778954,0.166200541696,0.167117269793,0.165371155763,0.164879390232,0.164724729986,0.16264738973,0.158491630294,0.156653546483,0.154144250075,0.152679405264,0.15095225722,0.15537686221,0.153978648188,0.153978648188,0.153767951198,0.153767951198,0.153767951198)
trans=0.5
age=(0:(55-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.480725263569), xlim = c(-57.75,2.75), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.69343249237), xlim = c(-57.75,2.75), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.46204904417, 0.400203909516), xlim = c(-57.75,2.75), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-57.75,2.75), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()