# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/longer-pyrate-run/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.16303220474, 0.16303220474,0.168024017756,0.166835899421,0.131269858933,0.0864974867037,0.0496206162388,0.0430393364271,0.0457728368254,0.0464269760031,0.0481793953251,0.0481793953251,0.0486950431062,0.0484107388825,0.0487510879789,0.0476342402906,0.053909920086,0.0544201520341,0.0565428041206,0.0574180577518,0.0610467790021,0.0747069066684,0.0799103862357,0.102155476792,0.106934448216,0.10730795187,0.106934448216,0.10730795187,0.106199024439,0.10730795187,0.102155476792,0.12915419716,0.131039576748,0.139890332588,0.138002289886,0.138002289886,0.136450372346,0.135036753603,0.134334878432,0.130658531214,0.12915419716,0.12915419716,0.127290155592,0.119515134865,0.119515134865,0.12023093481,0.120707878265,0.12023093481)
L_hpd_M95=c(0.350187892298, 0.350187892298,0.355697545652,0.355697545652,0.330473478646,0.32726224805,0.27914426257,0.230419234009,0.136235651623,0.135158301662,0.135640168868,0.135640168868,0.136083881167,0.135640168868,0.136083881167,0.138147457048,0.153611649817,0.164387499346,0.174236729945,0.181781185061,0.197119024578,0.222302700393,0.22407039858,0.23273916565,0.23475103953,0.234421792461,0.23475103953,0.236007504614,0.238798760954,0.249063046326,0.298037803082,0.371512605447,0.377201193704,0.391947324731,0.393564097672,0.39565172469,0.39565172469,0.395588865056,0.399126777408,0.398885102332,0.402282637434,0.406069973237,0.40659713808,0.399126777408,0.40046929923,0.403050618496,0.404201833275,0.404201833275)
M_hpd_m95=c(0.87168696106, 0.87168696106,0.0838070163749,0.0838070163749,0.0838070163749,0.0838070163749,0.0850096897721,0.0783702091143,0.0787124539831,0.0828249949951,0.0828249949951,0.0836668794337,0.0830975159266,0.0831413117345,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0830527864845,0.0820416454398,0.0830975159266,0.0824107162579,0.0828249949951,0.0820416454398,0.0823579431208,0.0820416454398,0.0820416454398,0.0820416454398,0.0820416454398,0.0820416454398,0.0820416454398,0.0820416454398)
M_hpd_M95=c(1.50923496479, 1.50923496479,0.187827476249,0.187827476249,0.188072131505,0.18738598256,0.182245820984,0.155758128427,0.139763952955,0.130691361874,0.126840920184,0.126857101233,0.124842323954,0.124842323954,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.124706421943,0.125242051264,0.126857101233,0.126857101233,0.127523500869,0.128114814914,0.129441856005,0.131623156753,0.132397089969,0.132397089969,0.132397089969,0.132397089969,0.132397089969,0.132397089969)
R_hpd_m95=c(-1.26682525876, -1.26682525876,0.0203498688173,0.0185002402162,0.0116563347654,-0.0249347431836,-0.0986897490303,-0.0928434236143,-0.0763011932376,-0.0727902580605,-0.0689979303324,-0.0688726383795,-0.0617436335426,-0.0617436335426,-0.0617194858026,-0.061345726413,-0.0617436335426,-0.0617436335426,-0.0581204899648,-0.051389617597,-0.0484675805297,-0.033999555805,-0.0238649137619,-0.00290831065618,0.000622457068978,0.000622457068978,0.00516140604474,0.00527023048539,0.00400205819336,0.000622457068978,0.000687594434223,0.0137403100875,0.0287513693509,0.0287513693509,0.042769090186,0.0366196872577,0.028077099694,0.0348938804654,0.0283266802055,0.028077099694,0.0249121424526,0.0171485198196,0.0140642243333,0.0145625267365,0.0140642243333,0.0115475027785,0.0113259076348,0.0113259076348)
R_hpd_M95=c(-0.612252902768, -0.612252902768,0.227182444495,0.225632966022,0.227182444495,0.226108166055,0.184531370686,0.135991877116,0.0468874173647,0.0340472108155,0.030675655347,0.0300679024334,0.0346202014577,0.0341991898616,0.0341991898616,0.0388684995085,0.0472950291921,0.0599374074347,0.071318427613,0.0842251938679,0.0961633947485,0.123195986692,0.127010216073,0.131939264039,0.133393491404,0.1326901112,0.13783966535,0.139028776143,0.140746277475,0.145561475069,0.199167739652,0.260775007938,0.284261120985,0.285935179844,0.304546980249,0.301236147545,0.29428889095,0.304659428275,0.301236147545,0.303476044722,0.304659428275,0.304546980249,0.303476044722,0.304659428275,0.304659428275,0.304659428275,0.304659428275,0.306634072772)
L_mean=c(0.25187143204, 0.25187143204,0.251816691149,0.25171301967,0.248284797506,0.238273861816,0.14034914959,0.0980742240191,0.0845016446454,0.0840114434003,0.0836823332829,0.0837089467251,0.083790335725,0.0838380392034,0.0842364002545,0.085582614623,0.0906438875994,0.0977374585852,0.104631637611,0.110784459075,0.121092673064,0.151249735132,0.163435635521,0.171761259367,0.17347721122,0.173788342149,0.174174987351,0.17500641888,0.176523850781,0.178915313424,0.192723758279,0.226698789575,0.243067018226,0.249157727752,0.254486440713,0.255448980274,0.255738325034,0.255909433952,0.256302627599,0.255873233069,0.256136974397,0.256249146258,0.255840495223,0.255108066462,0.255207297261,0.255492701457,0.255940915348,0.256341371281)
M_mean=c(1.15667033109, 1.15667033109,0.120826767265,0.120826767265,0.120828592569,0.12041360068,0.117224362291,0.111380298708,0.109019073859,0.10701812558,0.105949879451,0.105605603487,0.105279264508,0.105266416378,0.105264606258,0.105264606258,0.105259417269,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105249674569,0.105239326894,0.105190105373,0.104756658152,0.104547461934,0.104449640009,0.104427494294,0.104388175254,0.104394685506,0.104674535119,0.104606869049,0.104606869049,0.104606869049,0.104606869049,0.104606869049,0.104606869049)
R_mean=c(-0.904798899046, -0.904798899046,0.130989923884,0.130886252406,0.127456204936,0.117860261136,0.0231247872989,-0.0133060746887,-0.0245174292141,-0.0230066821798,-0.0222675461683,-0.0218966567615,-0.0214889287828,-0.0214283771748,-0.021028206003,-0.0196819916345,-0.0146155296693,-0.00751221598384,-0.000618036957696,0.00553478450597,0.0158429984951,0.0460000605631,0.0581859609516,0.0665115847976,0.0682275366507,0.0685386675799,0.0689253127818,0.0697567443113,0.0712741762123,0.0736656388549,0.0874740837102,0.121449115006,0.137817343657,0.143918400858,0.149296335341,0.150692322122,0.1511908631,0.151459793943,0.151875133305,0.151485057815,0.151742288891,0.151574611138,0.151233626174,0.150501197413,0.150600428212,0.150885832408,0.151334046299,0.151734502232)
trans=0.5
age=(0:(48-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.447256851888), xlim = c(-50.4,2.4), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.66015846127), xlim = c(-50.4,2.4), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.39350778464, 0.337297480049), xlim = c(-50.4,2.4), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-50.4,2.4), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()